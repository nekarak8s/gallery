"use strict";(self.webpackChunkgallery=self.webpackChunkgallery||[]).push([[653],{7653:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ve});var n=r(5466),s=r(3940),c=r(6207);const a={regex:/^[A-Za-z0-9ㄱ-ㅎㅏ-ㅣ가-힣\s]{1,15}$/,condition:"한/영/숫자 조합 1~15자로 입력해주세요"},o={regex:/^[\s\S]{1,150}$/,condition:"공백 포함 150자로 입력해주세요"},l={regex:/^[1-9]\d*$/,condition:"공간 식별값(숫자)이 올바르지 않습니다"};var i=r(5301),u=r(6735),d=r(3823);const p=["styles"];function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const j=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,p);return(0,d.jsx)("svg",m(m({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsx)("path",{fill:"currentColor",d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"})}))},h=["styles"];function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const b=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,h);return(0,d.jsx)("svg",x(x({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[(0,d.jsx)("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 00-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),(0,d.jsx)("path",{fill:"currentColor",d:"M7.94 13.06a1.5 1.5 0 010-2.12l5.656-5.658a1.5 1.5 0 112.121 2.122L11.122 12l4.596 4.596a1.5 1.5 0 11-2.12 2.122z"})]})}))},v=["styles"];function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const w=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,v);return(0,d.jsx)("svg",O(O({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[(0,d.jsx)("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 00-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z"}),(0,d.jsx)("path",{fill:"currentColor",d:"M16.06 10.94a1.5 1.5 0 010 2.12l-5.656 5.658a1.5 1.5 0 11-2.121-2.122L12.879 12 8.283 7.404a1.5 1.5 0 012.12-2.122z"})]})}))},P=e=>{let{id:t,className:r,name:n,value:s,label:c,defaultChecked:a,flexDirection:o="row",children:l}=e;return(0,d.jsxs)("label",{htmlFor:t,className:"radio ".concat(r||""),style:{flexDirection:o},onClick:e=>{e.stopPropagation()},children:[(0,d.jsxs)("div",{className:"radio__label",children:[(0,d.jsx)("input",{type:"radio",id:t,name:n,value:s,defaultChecked:a}),(0,d.jsx)("span",{children:c})]}),l]})};var D=r(7355);const _=e=>{let{placeList:t,defaultChecked:r}=e;const[s,c]=(0,n.useState)(0),a=(0,n.useMemo)((()=>t.length),[t]);(0,n.useEffect)((()=>{r||c(0);for(let e=0;e<t.length;e++)if(t[e].placeId===r){c(e);break}}),[t,r]);const o=(0,n.useCallback)((e=>{e.preventDefault(),c((e=>{const t=(e-1)%a;return t<0?t+a:t}))}),[a]),l=(0,n.useCallback)((e=>{e.preventDefault(),c((e=>(e+1)%a))}),[a]),i=(0,n.useRef)(null),u=(0,n.useRef)(!0);return(0,n.useEffect)((()=>{if(u.current)return void(u.current=!1);const e=i.current.querySelectorAll("label");e.forEach((e=>{e.style.transform="translateX(-".concat(100*s,"%)")})),setTimeout((()=>{e[s].click()}),300)}),[s]),(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"places-radio",children:[(0,d.jsx)("button",{className:"places-radio__left",type:"button",onClick:o,"data-cursor-scale":D.D,"aria-label":"이전 갤러리 공간 타입 선택",children:(0,d.jsx)(b,{})}),(0,d.jsx)("div",{className:"places-radio__container",ref:i,children:t.map(((e,t)=>(0,d.jsx)(P,{id:"place-".concat(e.placeId),name:"placeId",label:e.name,value:e.placeId,flexDirection:"column",defaultChecked:r?r===e.placeId:0===t,children:(0,d.jsx)("img",{src:e.threeDimensionImageUri,alt:"".concat(e.name," 공간")})},e.placeId)))}),(0,d.jsx)("button",{className:"places-radio__right",type:"button",onClick:l,"data-cursor-scale":D.D,"aria-label":"다음 갤러리 공간 타입 선택",children:(0,d.jsx)(w,{})}),(0,d.jsxs)("div",{className:"places-radio__image",children:[(0,d.jsx)("button",{type:"button","aria-label":"갤러리 2D 이미지 열기",children:(0,d.jsx)(j,{})}),(0,d.jsx)("img",{src:t[s].twoDimensionImageUri})]})]})})};var Z=r(8891),L=r(6738);const S=e=>{let{label:t,name:r,initialValue:s,maxLen:c,height:a="6.5em",onChange:o,readOnly:l=!1}=e;const[i,u]=(0,n.useState)(s.length),p=(0,n.useCallback)((e=>{u(e.currentTarget.value.length),c&&(e.currentTarget.value.length>c?e.currentTarget.classList.add("error"):e.currentTarget.classList.remove("error")),o&&o(e)}),[o,c]);return(0,d.jsxs)("div",{className:"textarea",children:[(0,d.jsx)("textarea",{name:r,defaultValue:s,onChange:p,placeholder:" ",style:{height:a},readOnly:l}),(0,d.jsx)("label",{children:t}),(0,d.jsx)("span",{children:"".concat(i).concat(c?" / ".concat(c):"")}),(0,d.jsx)("div",{})," "]})};var k=r(4813),E=r(2233),N=r(2731);const C=e=>{let{onSuccess:t,onError:r}=e;const{data:n,isLoading:s,isError:i}=(0,c.I_)(),{mutateAsync:u,isLoading:p}=(0,c.L9)();if(!i)return s?(0,d.jsx)(E.Z,{}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{className:"gallery-create-form",onSubmit:e=>{e.preventDefault(),e.stopPropagation();const n=e.currentTarget,s=function(e){const t=e.get("name");if(!a.regex.test(t))return{result:!1,reason:a.condition};const r=e.get("content");if(!o.regex.test(r))return{result:!1,reason:o.condition};const n=e.get("placeId");return l.regex.test(n)?{result:!0,data:{name:t,content:r,placeId:parseInt(n)}}:{result:!1,reason:l.condition}}(new FormData(n));s.result?u(s.data).then((()=>{n.reset(),t&&t()})).catch((()=>{r&&r()})):N.Z.addToast("error",s.reason)},children:[(0,d.jsx)(L.Z,{label:"전시회 이름",name:"name",initialValue:""}),(0,d.jsx)(S,{label:"소개글",name:"content",initialValue:"",maxLen:150}),(0,d.jsx)(_,{placeList:n,showSelected:!1}),(0,d.jsx)(k.Z,{type:"submit",direction:"left",ariaLabel:"전시회 생성",text:"전시회 개관"})]}),p&&(0,d.jsx)("div",{className:"gallery-create-form__loading",children:(0,d.jsx)(E.Z,{})})]})},I=["styles"];function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const R=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,I);return(0,d.jsx)("svg",q(q({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsx)("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 01-2 0v-5H6a1 1 0 010-2h5v-5a1 1 0 012 0v5h5a1 1 0 010 2z"})}))};var F=r(351);const A=()=>{const[e,t]=(0,n.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"gallery-create","data-cursor-scale":D.D,onClick:()=>{t(!0)},"aria-label":"전시회 생성",children:(0,d.jsx)(R,{})}),(0,d.jsx)(F.Z,{isOpen:e,onClose:()=>t(!1),children:(0,d.jsx)(C,{onSuccess:()=>t(!1)})})]})};var M=r(1807);const z=e=>{let{galleryId:t,onSuccess:r,onError:n}=e;const{mutateAsync:s,isLoading:a}=(0,c.pB)(t);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{className:"gallery-delete-form",onSubmit:function(e){e.stopPropagation(),e.preventDefault(),s().then((()=>{r&&r()})).catch((()=>{n&&n()}))},children:[(0,d.jsx)("p",{children:"정말 갤러리를 삭제하시겠습니까?"}),(0,d.jsx)(k.Z,{color:"red",type:"submit",direction:"left",ariaLabel:"갤러리 수정",text:"삭제하기"})]}),a&&(0,d.jsx)("div",{className:"gallery-delete-form__loading",children:(0,d.jsx)(E.Z,{})})]})},V=["styles"];function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const $=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,V);return(0,d.jsx)("svg",H(H({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48"},r),{},{children:(0,d.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M19 10a4 4 0 11-8 0 4 4 0 018 0m-4 18a4 4 0 100-8 4 4 0 000 8m0 14a4 4 0 100-8 4 4 0 000 8m22-32a4 4 0 11-8 0 4 4 0 018 0m-4 18a4 4 0 100-8 4 4 0 000 8m0 14a4 4 0 100-8 4 4 0 000 8",clipRule:"evenodd"})}))},U=e=>{let{id:t,className:r,name:s,label:c,value:a,falseValue:o,onChange:l,defaultChecked:i=!1,children:u}=e;const[p,g]=(0,n.useState)(i);return(0,d.jsxs)("label",{htmlFor:t,className:"checkbox ".concat(r||""),onClick:e=>{e.stopPropagation()},children:[!p&&(0,d.jsx)("input",{type:"hidden",name:s,value:o}),(0,d.jsxs)("div",{className:"checkbox__label",children:[(0,d.jsx)("input",{id:t,type:"checkbox",name:s,value:a,defaultChecked:i,onChange:function(e){e.stopPropagation(),g(e.target.checked),l&&l(e)}}),c]}),u]})},W=e=>{let{id:t,className:r,name:s,accept:c,uploadBtnText:a="업로드",resetBtnText:o="취소",onChange:l,onReset:i}=e;const u=(0,n.useRef)(null);return(0,d.jsxs)("div",{className:"file ".concat(r||""),children:[(0,d.jsx)("input",{id:t,ref:u,type:"file",name:s,accept:c,onChange:l,"data-cursor-scale":D.D}),(0,d.jsxs)("div",{className:"file__buttons",children:[(0,d.jsx)(k.Z,{text:a,onClick:e=>{e.preventDefault(),e.stopPropagation();u.current.click()},size:"sm"}),(0,d.jsx)(k.Z,{text:o,onClick:e=>{e.preventDefault(),e.stopPropagation();u.current.value="",i&&i()},size:"sm"})]})]})};var G=r(4553),J=r(9451),X=r(4469),K=r(9093);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ee=function(e){let{music:t}=e;return(0,d.jsxs)("div",{className:"music-search-item",children:[(0,d.jsx)("img",{src:t.coverURL}),(0,d.jsx)("div",{className:"music-search-item__text",children:(0,d.jsx)("p",{children:(t.title+" - "+t.artist+"        ").repeat(10)})})]})};var te=r(8162);const re=e=>{let{onSelect:t}=e;const[r,s]=(0,n.useState)(""),{data:c,isFetching:a,refetch:o}=function(e,t){return(0,J.a)(["music",{query:e}],(()=>K.Z.get("/post/music/list",{params:{q:e}})),Y({onSuccess:()=>{},onError:e=>{N.Z.addToast("error",e.message)},select:e=>e.data,enabled:!1},t))}(r),l=(0,te.Z)(r,300);(0,n.useEffect)((()=>{l&&o()}),[l]);const{mutateAsync:i,isLoading:u}=(0,X.D)((e=>K.Z.post("/post/music",e)),Y({onSuccess:()=>{},onError:e=>{N.Z.addToast("error",e.message)}},p));var p;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"music-search",children:[(0,d.jsx)(L.Z,{label:"음악 검색",name:"music",initialValue:"",onChange:e=>s(e.target.value)}),(0,d.jsxs)(Z.Z,{className:"music-search__form",onSubmit:e=>{if(e.preventDefault(),e.stopPropagation(),!c)return;const r=e.currentTarget,n=new FormData(r),s=Number(n.get("musicIndex"));i(c[s]).then((e=>{r.reset(),t(e.data)}))},children:[(0,d.jsx)("ul",{className:"music-search__list",children:a?(0,d.jsx)(E.Z,{}):null==c?void 0:c.map(((e,t)=>(0,d.jsx)("li",{children:(0,d.jsx)(P,{id:"music-search-".concat(t),name:"musicIndex",value:t,children:(0,d.jsx)(ee,{music:e})})},"".concat(e.artist,"-").concat(e.title,"-").concat(e.releasedDate))))}),(0,d.jsx)(k.Z,{type:"submit",text:"음악 선택",ariaLabel:"음악 선택"})]})]}),u&&(0,d.jsx)("div",{className:"music-search__loading",children:(0,d.jsx)(E.Z,{})})]})};var ne=r(2561);const se=e=>{let{post:t,index:r}=e;const s=(0,ne.Z)(),c=(0,n.useRef)(null),[a,o]=(0,n.useState)(t.title),[l,i]=(0,n.useState)(t.isActive),[u,p]=(0,n.useState)(t.imageURL),g=(0,n.useMemo)((()=>t.imageURL),[]),[m,j]=(0,n.useState)(!1),[h,f]=(0,n.useState)(t.music);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("article",{className:"post-item-form",ref:c,children:[(0,d.jsxs)("div",{className:"post-item-form__header ".concat(l||"inactive"),tabIndex:0,onClick:()=>{var e;null===(e=c.current)||void 0===e||e.classList.toggle("open")},children:[(0,d.jsx)("input",{type:"hidden",name:"posts[".concat(r,"].postId"),value:t.postId}),(0,d.jsx)("input",{type:"hidden",name:"posts[".concat(r,"].order"),value:r+1}),!s&&(0,d.jsx)("div",{className:"post-item-form__drag","data-cursor-scale":D.D,children:(0,d.jsx)($,{})}),(0,d.jsxs)("div",{className:"post-item-form__order-title",children:[(0,d.jsx)("span",{className:"post-item-form__toggle",children:"▶"}),(0,d.jsxs)("span",{children:[r+1,"번"]}),(0,d.jsx)("span",{children:"|"}),(0,d.jsx)("h2",{children:a})]}),(0,d.jsx)(U,{name:"posts[".concat(r,"].isActive"),value:"true",falseValue:"false",label:l?"전시 중":"보관 중",defaultChecked:t.isActive,onChange:e=>{i(e.target.checked)}})]}),(0,d.jsxs)("div",{className:"post-item-form__card",children:[(0,d.jsx)("img",{src:u}),(0,d.jsx)(W,{name:"posts[".concat(r,"].image"),accept:"image/png, image/jpeg",onChange:e=>{if(!e.target.files||!e.target.files.length)return;const t=new FileReader,r=e.target.files[0];t.readAsDataURL(r),t.onload=function(){"string"==typeof t.result&&p(t.result)}},onReset:()=>{p(g)}}),(0,d.jsxs)("div",{className:"post-item-form__music",children:[(0,d.jsxs)(G.Z,{name:"posts[".concat(r,"].musicId"),children:[h&&(0,d.jsxs)("option",{selected:!0,className:"post-form__music",value:h.musicId,children:[h.title," - ",h.artist]}),(0,d.jsx)("option",{value:"",children:"노래 없음"})]}),(0,d.jsx)(k.Z,{text:"음악 선택",size:"sm",onClick:()=>j(!0)})]}),(0,d.jsx)(L.Z,{label:"제목",name:"posts[".concat(r,"].title"),initialValue:t.title,onChange:e=>{o(e.target.value)}}),(0,d.jsx)(S,{label:"설명",name:"posts[".concat(r,"].content"),initialValue:t.content,height:"4em",maxLen:500})]})]}),(0,d.jsx)(F.Z,{isOpen:m,onClose:()=>j(!1),children:(0,d.jsx)(re,{onSelect:e=>{f(e),j(!1)}})})]})},ce=e=>{let{postList:t}=e;const[r,s]=(0,n.useState)(t),c=(0,n.useRef)(null),a=(0,n.useRef)(null),o=e=>{if(e.currentTarget.classList.remove("dragging"),null===c.current||null===a.current)return;const t=[...r];t[c.current]=r[a.current],t[a.current]=r[c.current],s(t),c.current=null,a.current=null},l=(0,ne.Z)();return(0,d.jsxs)("div",{className:"post-list-form",children:[!l&&(0,d.jsx)("p",{children:"* 드래그하여 작품 순서를 바꿀 수 있습니다."}),(0,d.jsx)("ol",{children:r.map(((e,t)=>(0,d.jsx)("li",{draggable:!0,onDragStart:e=>((e,t)=>{e.currentTarget.classList.add("dragging"),c.current=t})(e,t),onDragOver:e=>((e,t)=>{e.preventDefault(),a.current=t})(e,t),onDragEnd:o,children:(0,d.jsx)(se,{post:e,index:t})},"".concat(e.postId,"-").concat((new Date).toISOString()))))})]})};var ae=r(2480);const oe={regex:/^[1-9]\d*$/,condition:"공간 식별값(숫자)이 올바르지 않습니다"},le={regex:/^[1-9]|10$/,condition:"게시물의 순서(1~10)가 올바르지 않습니다"},ie={regex:/^[A-Za-z0-9ㄱ-ㅎㅏ-ㅣ가-힣\s]{1,15}$/,condition:"한/영/숫자 조합 1~15자 이내로 입력해주세요"},ue={regex:/^[\s\S]{1,500}$/,condition:"공백 포함 1~500자 이내로 입력해주세요"},de={regex:/^[1-9]\d*$/,condition:"음악 식별값(숫자)이 올바르지 않습니다"},pe={regex:/^(false|true)$/,condition:"게시물 활성화 여부값 올바르지 않습니다"};async function ge(e,t){return new Promise(((r,n)=>{t.onload=t=>{var s;const c=new Image;c.src=null===(s=t.target)||void 0===s?void 0:s.result,c.onload=()=>{const t=document.createElement("canvas"),s=t.getContext("2d"),a=c.width<c.height?c.width:c.height;t.width=800,t.height=800,null==s||s.drawImage(c,c.width/2-a/2,c.height/2-a/2,c.width/2+a/2,c.height/2+a/2,0,0,800,800),t.toBlob((t=>{if(t){const n=new File([t],e.name,{type:e.type});r(n)}else n(new Error("이미지 변환 실패"))}),e.type)}},t.onerror=()=>{n(new Error("이미지 로딩 실패"))},t.readAsDataURL(e)}))}const me=e=>{let{galleryId:t,onSuccess:r,onError:s}=e;const{data:i,isLoading:u,isError:p}=(0,c.rp)(t),{data:g,isLoading:m,isError:j}=(0,c.I_)(),{data:h,isLoading:f,isError:x}=(0,ae.N)(t),{mutateAsync:b,isLoading:v}=(0,c.gz)(t),{mutateAsync:y,isLoading:O}=(0,ae.$)(t),[w,P]=(0,n.useState)(!1);return p||j||x?null:u||m||f?(0,d.jsx)(E.Z,{}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{className:"gallery-update-form",onSubmit:async e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget,n=new FormData(t);for(let e of n.keys());const c=function(e){const t=e.get("name");if(!a.regex.test(t))return{result:!1,reason:a.condition};e.delete("name");const r=e.get("content");if(!o.regex.test(r))return{result:!1,reason:o.condition};e.delete("content");const n=e.get("placeId");return l.regex.test(n)?(e.delete("placeId"),{result:!0,data:{name:t,content:r,placeId:parseInt(n)}}):{result:!1,reason:l.condition}}(n);if(!c.result)return void N.Z.addToast("error",c.reason);const i=await async function(e){const t=["image/jpeg","image/png","image/webp"],r=new FileReader;for(let n=0;n<10;n++){const s=e.get("posts[".concat(n,"].postId"));if(!oe.regex.test(s))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(oe.condition)};const c=e.get("posts[".concat(n,"].order"));if(!le.regex.test(c))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(le.condition)};const a=e.get("posts[".concat(n,"].title"));if(!ie.regex.test(a))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(ie.condition)};const o=e.get("posts[".concat(n,"].content"));if(!ue.regex.test(o))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(ue.condition)};const l=e.get("posts[".concat(n,"].musicId"));if(l&&!de.regex.test(l))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(de.condition)};const i=e.get("posts[".concat(n,"].isActive"));if(!pe.regex.test(i))return{result:!1,reason:"".concat(n+1,"번째 게시물: ").concat(pe.condition)};const u=e.get("posts[".concat(n,"].image"));if(e.delete("posts[".concat(n,"].image")),t.includes(u.type))try{const t=await ge(u,r);e.append("posts[".concat(n,"].image"),t)}catch(e){return{result:!1,reason:"".concat(n+1,"번째 게시물: 이미지 변환 실패")}}}return{result:!0,data:e}}(n);i.result?b(c.data).then((()=>{y(i.data)})).then((()=>{t.reset(),r&&r()})).catch((()=>{s&&s()})):N.Z.addToast("error",i.reason)},children:[(0,d.jsx)(L.Z,{label:"전시회 이름",name:"name",initialValue:i.name}),(0,d.jsx)(S,{label:"소개글",name:"content",maxLen:500,initialValue:i.content}),(0,d.jsx)(_,{placeList:g,defaultChecked:i.place.placeId}),(0,d.jsx)(ce,{postList:h}),(0,d.jsxs)("div",{className:"gallery-update-form__buttons",children:[(0,d.jsx)(k.Z,{type:"submit",direction:"center",ariaLabel:"전시회 생성",text:"수정하기"}),(0,d.jsx)(k.Z,{color:"red",ariaLabel:"전시회 삭제",text:"삭제하기",onClick:()=>P(!0)})]})]}),(v||O)&&(0,d.jsx)("div",{className:"gallery-update-form__loading",children:(0,d.jsx)(E.Z,{})}),w&&(0,d.jsx)(F.Z,{isOpen:w,onClose:()=>P(!1),children:(0,d.jsx)(z,{galleryId:t,onSuccess:()=>{r&&r(),P(!1)},onError:()=>{s&&s(),P(!1)}})})]})},je=["styles"];function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const xe=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,je);return(0,d.jsxs)("svg",fe(fe({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:[(0,d.jsx)("path",{fill:"currentColor",d:"M18.988 2.012l3 3L19.701 7.3l-3-3zM8 16h3l7.287-7.287-3-3L8 13z"}),(0,d.jsx)("path",{fill:"currentColor",d:"M19 19H8.158c-.026 0-.053.01-.079.01-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .896-2 2v14c0 1.104.897 2 2 2h14a2 2 0 002-2v-8.668l-2 2V19z"})]}))},be=["styles"];function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Oe=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,be);return(0,d.jsx)("svg",ye(ye({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsx)("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 4h10v14a2 2 0 01-2 2H9m3-5l3-3m0 0l-3-3m3 3H5"})}))},we=["styles"];function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const _e=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,we);return(0,d.jsx)("svg",De(De({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,d.jsx)("path",{fill:"currentColor",d:"M18 22q-1.25 0-2.125-.875T15 19q0-.175.025-.363t.075-.337l-7.05-4.1q-.425.375-.95.588T6 15q-1.25 0-2.125-.875T3 12q0-1.25.875-2.125T6 9q.575 0 1.1.213t.95.587l7.05-4.1q-.05-.15-.075-.337T15 5q0-1.25.875-2.125T18 2q1.25 0 2.125.875T21 5q0 1.25-.875 2.125T18 8q-.575 0-1.1-.212t-.95-.588L8.9 11.3q.05.15.075.338T9 12q0 .175-.025.363T8.9 12.7l7.05 4.1q.425-.375.95-.587T18 16q1.25 0 2.125.875T21 19q0 1.25-.875 2.125T18 22"})}))},Ze=e=>{let{gallery:t}=e;const[r,s]=(0,n.useState)(!1),c=(0,M.s0)(),a=(0,n.useRef)(null),o=(0,n.useRef)(null),l=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const e=a.current,r=o.current.querySelectorAll("button"),n=l.current;let s=0,c=null;const i=function(){e.classList.add("selected"),c||(c=setInterval((()=>{n.textContent+=t.content.charAt(s),s+=1}),20))},u=function(){e.classList.remove("selected"),c&&clearInterval(c),c=null,n.textContent="",s=0};return e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",u),r.forEach((e=>{e.addEventListener("focus",i),e.addEventListener("blur",u)})),()=>{e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",u),r.forEach((e=>{e.removeEventListener("focus",i),e.removeEventListener("blur",u)})),c&&clearInterval(c)}}),[t]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("article",{tabIndex:0,className:"gallery-item",ref:a,children:[(0,d.jsx)("h2",{className:"gallery-item__title",children:t.name}),(0,d.jsxs)("ul",{className:"gallery-item__icons",ref:o,"data-cursor-scale":D.D,children:[(0,d.jsx)("li",{children:(0,d.jsx)("button",{"data-cursor-scale":D.D,"aria-label":"".concat(t.name," 갤러리 입장"),onClick:e=>{e.stopPropagation(),c("/gallery/".concat(t.galleryId))},children:(0,d.jsx)(Oe,{})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{"data-cursor-scale":D.D,"aria-label":"".concat(t.name," 갤러리 공유"),onClick:e=>{e.stopPropagation(),navigator.canShare()?navigator.share({title:"".concat(t.name),text:"".concat(t.name," 전시회에 초대합니다"),url:"".concat(window.location.protocol,"://").concat(window.location.hostname,":").concat(window.location.port).concat("/gallery","/gallery/").concat(t.galleryId)}):navigator.clipboard.writeText("".concat(window.location.protocol,"://").concat(window.location.hostname,":").concat(window.location.port).concat("/gallery","/gallery/").concat(t.galleryId)).then((()=>{N.Z.addToast("success","클립보드에 복사되었습니다")})).catch((()=>{N.Z.addToast("error","클립보드 복사에 실패했습니다")}))},children:(0,d.jsx)(_e,{})})}),(0,d.jsx)("li",{children:(0,d.jsx)("button",{"data-cursor-scale":D.D,"aria-label":"".concat(t.name," 갤러리 수정"),onClick:()=>s(!0),children:(0,d.jsx)(xe,{})})})]}),(0,d.jsxs)("div",{className:"gallery-item__content",children:[(0,d.jsx)("div",{ref:l}),(0,d.jsx)("p",{children:t.content})]}),(0,d.jsx)("time",{className:"gallery-item__date",children:new Date(t.createdDate).toLocaleDateString()}),(0,d.jsxs)("div",{className:"gallery-item__borders",children:[(0,d.jsx)("div",{}),(0,d.jsx)("div",{}),(0,d.jsx)("div",{}),(0,d.jsx)("div",{})]})]}),(0,d.jsx)(F.Z,{isOpen:r,onClose:()=>s(!1),children:(0,d.jsx)(me,{galleryId:t.galleryId,onSuccess:()=>s(!1)})})]})},Le=()=>{const e=(0,n.useRef)(null),{data:t,isLoading:r,isError:s}=(0,c.Gd)();return(0,n.useEffect)((()=>{if(!t)return;const r=new IntersectionObserver((e=>{e.forEach((e=>{e.target.classList.toggle("show",e.isIntersecting),e.isIntersecting&&r.unobserve(e.target)}),{rootMargin:"-150px"})}));e.current.querySelectorAll(".gallery-list__item").forEach((e=>{r.observe(e)}))}),[t]),r?(0,d.jsx)(E.Z,{}):s?void 0:(0,d.jsxs)("div",{className:"gallery-list",ref:e,children:[(0,d.jsx)(A,{}),t.map((e=>(0,d.jsx)("div",{className:"gallery-list__item",children:(0,d.jsx)(Ze,{gallery:e})},e.galleryId)))]})},Se=e=>{let{user:t}=e;const[r,s]=(0,n.useState)(0);return(0,n.useEffect)((()=>{if(!t)return;s(Math.floor(((new Date).getTime()-new Date(t.createdDate).getTime())/6e4));const e=setInterval((()=>{s((e=>e+1))}),6e4);return()=>{e&&clearInterval(e)}}),[t]),(0,d.jsxs)("div",{className:"profile",children:[(0,d.jsxs)("span",{children:[t.nickname,"님의 작업실"]}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{children:r}),"분 운영 중"]})]})};var ke=r(966);const Ee=e=>{let{onSuccess:t,onError:r}=e;const{data:n,isLoading:s,isError:c}=(0,ke.bT)(),{mutateAsync:a,isLoading:o}=(0,ke.JN)();return s?(0,d.jsx)(E.Z,{}):c?null:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{className:"withdrawl-form",onSubmit:function(e){e.preventDefault(),e.stopPropagation();const s=e.currentTarget;new FormData(s).get("nickname")===(null==n?void 0:n.nickname)?a().then((()=>{s.reset(),t&&t()})).catch((()=>{r&&r()})):N.Z.addToast("error","닉네임이 올바르지 않습니다")},children:[(0,d.jsxs)("p",{children:["본인의 닉네임 ",(0,d.jsx)("b",{children:null==n?void 0:n.nickname}),"을 입력해주세요"]}),(0,d.jsx)(L.Z,{label:"닉네임",name:"nickname",initialValue:""}),(0,d.jsx)(k.Z,{text:"회원 탈퇴",type:"submit",color:"red"})]}),o&&(0,d.jsx)("div",{className:"withdrawl-form__loading",children:(0,d.jsx)(E.Z,{})})]})};var Ne=r(6001);const Ce=["styles"];function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const qe=e=>{let{styles:t={}}=e,r=(0,u.Z)(e,Ce);return(0,d.jsx)("svg",Te(Te({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},r),{},{children:(0,d.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",children:[(0,d.jsx)("circle",{cx:"8",cy:"2.5",r:".9"}),(0,d.jsx)("circle",{cx:"8",cy:"8",r:".9"}),(0,d.jsx)("circle",{cx:"8",cy:"13.5",r:".9"})]})}))};var Re=r(7135),Fe=r(2914);const Ae={regex:/^[A-Za-z\dㄱ-ㅎㅏ-ㅣ가-힣]{2,10}$/,condition:"닉네임은 한/영 조합 2~10자로 입력해주세요"};const Me=e=>{let{onSuccess:t,onError:r}=e;const{mutateAsync:n,isLoading:s}=(0,ke.Io)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{className:"profile-form",onSubmit:function(e){e.preventDefault(),e.stopPropagation();const s=e.currentTarget,c=function(e){const t=e.get("nickname");return Ae.regex.test(t)?{result:!0,data:{nickname:t}}:{result:!1,reason:Ae.condition}}(new FormData(s));c.result?n(c.data).then((()=>{s.reset(),t&&t()})).catch((()=>{r&&r()})):N.Z.addToast("error","".concat(c.reason))},children:[(0,d.jsx)(L.Z,{label:"닉네임",name:"nickname",initialValue:""}),(0,d.jsx)(k.Z,{type:"submit",direction:"left",ariaLabel:"닉네임 수정",text:"수정하기"})]}),s&&(0,d.jsx)("div",{className:"profile-form__loading",children:(0,d.jsx)(E.Z,{})})]})},ze=()=>{const e=(0,M.s0)(),{mutateAsync:t}=(0,ke.aU)(),[r,s]=(0,n.useState)(!1),[c,a]=(0,n.useState)(!1),o=(0,n.useRef)(null),[l,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=o.current,t=function(){i(!0)},r=function(){i(!1)};return e.addEventListener("mouseenter",t),e.addEventListener("mouseleave",r),()=>{e.removeEventListener("mouseenter",t),e.removeEventListener("mouseleave",r)}}),[]),(0,d.jsxs)("div",{className:"profile-edit",ref:o,children:[(0,d.jsx)(Re.Z,{ariaLabel:"메뉴 더보기",onFocus:()=>i(!0),children:(0,d.jsx)("div",{className:"profile-edit__toggle",children:(0,d.jsx)(qe,{})})}),(0,d.jsxs)(Fe.Z,{className:"profile-edit__menu",isShow:l,duration:200,timingFunction:"ease-in-out",children:[(0,d.jsx)(k.Z,{ariaLabel:"정보수정",text:"닉네임 수정",direction:"right",onClick:()=>s(!0)}),(0,d.jsx)(k.Z,{ariaLabel:"로그아웃",text:"로그아웃",direction:"center",onClick:()=>{t().then((()=>{e(Ne._.Home.path)}))}}),(0,d.jsx)(k.Z,{ariaLabel:"회원탈퇴",text:"회원탈퇴",direction:"bottom",color:"red",onClick:()=>a(!0),onBlur:()=>i(!1)})]}),(0,d.jsx)(F.Z,{isOpen:r,onClose:()=>s(!1),children:(0,d.jsx)(Me,{onSuccess:()=>s(!1)})}),(0,d.jsx)(F.Z,{isOpen:c,onClose:()=>a(!1),children:(0,d.jsx)(Ee,{onSuccess:()=>{a(!1),e(Ne._.Home.path)}})})]})};const Ve=function(){const{data:e,isLoading:t,isError:r}=(0,ke.bT)();return(0,n.useEffect)((()=>{window.scrollTo(0,0)}),[]),t?(0,d.jsx)(s.Z,{}):r?(0,d.jsx)("div",{}):(0,d.jsxs)("div",{className:"my-page",children:[(0,d.jsxs)("section",{className:"my-page__profile",onAnimationEnd:function(){var e,t,r;null===(e=document.querySelector(".my-page__profile-edit"))||void 0===e||e.classList.add("block"),null===(t=document.querySelector(".my-page__line"))||void 0===t||t.classList.add("block"),null===(r=document.querySelector(".my-page__gallery"))||void 0===r||r.classList.add("block")},children:[(0,d.jsx)(Se,{user:e}),(0,d.jsx)("div",{className:"my-page__profile-edit",children:(0,d.jsx)(ze,{})})]}),(0,d.jsx)("div",{className:"my-page__line"}),(0,d.jsx)("section",{className:"my-page__gallery",children:(0,d.jsx)(Le,{})})]})}}}]);