"use strict";(self.webpackChunkgallery=self.webpackChunkgallery||[]).push([[743],{743:(t,e,i)=>{i.d(e,{o:()=>a});var o=i(4599);const s=new o.Pa4,n=new o.$V,h=new o.Pa4;class a{constructor(t,e){this.object=t,this.domElement=e,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let i=0,a=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(t){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(t.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onPointerUp=function(t){if(this.activeLook)switch(t.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onPointerMove=function(t){this.domElement===document?(this.pointerX=t.pageX-this.viewHalfX,this.pointerY=t.pageY-this.viewHalfY):(this.pointerX=t.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=t.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(t){switch(t.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}},this.onKeyUp=function(t){switch(t.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}},this.lookAt=function(t,e,i){return t.isVector3?h.copy(t):h.set(t,e,i),this.object.lookAt(h),w(this),this},this.update=function(){const t=new o.Pa4;return function(e){if(!1===this.enabled)return;if(this.heightSpeed){const t=o.M8C.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=e*(t*this.heightCoef)}else this.autoSpeedFactor=0;const s=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(s+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(s),this.moveLeft&&this.object.translateX(-s),this.moveRight&&this.object.translateX(s),this.moveUp&&this.object.translateY(s),this.moveDown&&this.object.translateY(-s);let n=e*this.lookSpeed;this.activeLook||(n=0);let h=1;this.constrainVertical&&(h=Math.PI/(this.verticalMax-this.verticalMin)),a-=this.pointerX*n,this.lookVertical&&(i-=this.pointerY*n*h),i=Math.max(-85,Math.min(85,i));let r=o.M8C.degToRad(90-i);const c=o.M8C.degToRad(a);this.constrainVertical&&(r=o.M8C.mapLinear(r,0,Math.PI,this.verticalMin,this.verticalMax));const d=this.object.position;t.setFromSphericalCoords(1,r,c).add(d),this.object.lookAt(t)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",r),this.domElement.removeEventListener("pointerdown",d),this.domElement.removeEventListener("pointermove",c),this.domElement.removeEventListener("pointerup",m),window.removeEventListener("keydown",v),window.removeEventListener("keyup",l)};const c=this.onPointerMove.bind(this),d=this.onPointerDown.bind(this),m=this.onPointerUp.bind(this),v=this.onKeyDown.bind(this),l=this.onKeyUp.bind(this);function w(t){const e=t.object.quaternion;s.set(0,0,-1).applyQuaternion(e),n.setFromVector3(s),i=90-o.M8C.radToDeg(n.phi),a=o.M8C.radToDeg(n.theta)}this.domElement.addEventListener("contextmenu",r),this.domElement.addEventListener("pointerdown",d),this.domElement.addEventListener("pointermove",c),this.domElement.addEventListener("pointerup",m),window.addEventListener("keydown",v),window.addEventListener("keyup",l),this.handleResize(),w(this)}}function r(t){t.preventDefault()}}}]);