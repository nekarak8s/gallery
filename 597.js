"use strict";(self.webpackChunkgallery=self.webpackChunkgallery||[]).push([[597],{2597:(e,t,r)=>{r.r(t),r.d(t,{default:()=>J});var n=r(7363);const s={nickname:"홍길동",role:"회원",createdDate:"2023-09-27 22:00:59"},a="Profile-module__profile--roj_u";var l=r(3823);const c=()=>{const e=(0,n.useRef)(null),t=s;return(0,n.useEffect)((()=>{if(!t)return;const r=e.current;let n=Math.floor(((new Date).getTime()-new Date(t.createdDate).getTime())/6e4);r.textContent=n.toString();const s=setInterval((()=>{n+=1,r.textContent=n.toString()}),6e4);return setTimeout((()=>{var e;null===(e=document.querySelector(".my-page__profile"))||void 0===e||e.classList.add("loaded")}),1e3),setTimeout((()=>{var e,t,r;null===(e=document.querySelector(".my-page__br"))||void 0===e||e.classList.add("opaque"),null===(t=document.querySelector(".my-page__profile__btn"))||void 0===t||t.classList.add("block"),null===(r=document.querySelector(".my-page__gallery"))||void 0===r||r.classList.add("block")}),1500),()=>{s&&clearInterval(s)}}),[t]),(0,l.jsxs)("div",{className:a,children:[(0,l.jsxs)("span",{children:[t.nickname,"님의 작업실"]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("span",{ref:e}),"분 운영 중"]})]})};var o=r(7355),i=r(3165);const u=e=>{let{label:t,name:r,initialValue:s,onChange:a}=e;const[c,o]=(0,n.useState)(s),i=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i.current.classList.toggle("fill",c.length>0)}),[c]),(0,l.jsxs)("div",{className:"text",children:[(0,l.jsx)("input",{ref:i,name:r,type:"text",value:c,onChange:e=>{a&&a(e),o(e.target.value.trim())}}),(0,l.jsx)("label",{children:t})]})},m=e=>{let{label:t,name:r,initialValue:s,onChange:a}=e;const[c,o]=(0,n.useState)(s),i=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i.current.classList.toggle("fill",c.length>0)}),[c]),(0,l.jsxs)("div",{className:"textarea",children:[(0,l.jsx)("textarea",{ref:i,name:r,value:c,onChange:e=>{a&&a(e),o(e.target.value.trim())}}),(0,l.jsx)("label",{children:t})]})},d=e=>{let{id:t,name:r,value:n,label:s="",children:a}=e;return(0,l.jsxs)("label",{htmlFor:t,className:"radio",children:[(0,l.jsxs)("div",{className:"radio__label",children:[(0,l.jsx)("input",{type:"radio",id:t,name:r,value:n})," ",s]}),a]})};var p=r(9093),g=r(9451),j=r(5945),f=r(4469),h=r(2731);r.p,r.p,r.p,r.p,r.p,r.p,r.p,r.p;const x=[{placeId:1,name:"공간1",maximumFrameNumber:10,twoDimensionImageUrl:"https://source.unsplash.com/random/300×300",threeDimensionImageUrl:"https://source.unsplash.com/random/300×300"},{placeId:2,name:"공간2",maximumFrameNumber:10,twoDimensionImageUrl:"https://source.unsplash.com/random/300×300",threeDimensionImageUrl:"https://source.unsplash.com/random/300×300"},{placeId:3,name:"공간3",maximumFrameNumber:10,twoDimensionImageUrl:"https://source.unsplash.com/random/300×300",threeDimensionImageUrl:"https://source.unsplash.com/random/300×300"}],v=e=>{let{text:t,ariaLabel:r=t,direction:s="left",type:a="button",size:c="md",color:i="black",onClick:u=(()=>{})}=e;const m=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const e=m.current,t=function(t){"Enter"===t.key&&e.click()};return e.addEventListener("keyup",t),()=>{e.removeEventListener("keyup",t)}}),[]),(0,l.jsx)("button",{ref:m,"data-cursor-scale":o.D,type:a,onClick:u,"aria-label":r,className:"button ".concat(s," ").concat(c," ").concat(i),children:t})},b={reg:/^[A-Za-z0-9가-힣\s]{1,15}$/,con:"한/영/숫자 조합 1~15자로 입력해주세요"},y={reg:/[\s\S]{1,150}/,con:"공백 포함 150자로 입력해주세요"},O={reg:/^[1-9]\d*$/,con:"공간값(숫자)이 올바르지 않습니다"};const w=()=>{const e=x,{mutate:t}=function(){const e=(0,j.NL)();return(0,f.D)((e=>p.Z.patch("/member",e)),{onSuccess:t=>{console.log(1,t),e.invalidateQueries(["gallery-list"])},onError:e=>{h.Z.addToast("error",e.message)}})}();return(0,l.jsxs)("form",{className:"gallery-form",onSubmit:function(e){e.preventDefault();const r=function(e){const t=e.get("name");if(!b.reg.test(t))return{result:!1,reason:b.con};const r=e.get("content");if(!y.reg.test(r))return{result:!1,reason:y.con};const n=e.get("placeId");return O.reg.test(n)?{result:!0,data:{name:t,content:r,placeId:parseInt(n)}}:{result:!1,reason:O.con}}(new FormData(e.currentTarget));r.result?t(r.data):h.Z.addToast("error",r.reason)},children:[(0,l.jsx)("h2",{children:"전시회 정보"}),(0,l.jsx)(u,{label:"이름",name:"name",initialValue:""}),(0,l.jsx)(m,{label:"소개글",name:"description",initialValue:""}),(0,l.jsx)("div",{className:"gallery-form__place",children:e.map((e=>(0,l.jsx)(d,{id:"place-".concat(e.placeId),name:"placeId",label:e.name,value:e.placeId,children:(0,l.jsx)("img",{src:e.twoDimensionImageUrl,alt:"".concat(e.name," 공간")})})))}),(0,l.jsx)(v,{type:"submit",direction:"left",ariaLabel:"전시회 생성",text:"전시회 개관"})]})},D=()=>{const[e,t]=(0,n.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"gallery-create","data-cursor-scale":o.D,onClick:()=>{t(!0)},children:"+"}),(0,l.jsx)(i.Z,{isOpen:e,onClose:()=>t(!1),children:(0,l.jsx)(w,{})})]})};var _=r(5301),L=r(6735);const E=["styles"];function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,_.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const C=e=>{let{styles:t={}}=e,r=(0,L.Z)(e,E);return(0,l.jsx)("svg",N(N({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,l.jsx)("path",{fill:"currentColor",d:"M12 2a10 10 0 1010 10A10 10 0 0012 2zm-2 14.5v-9l6 4.5z"})}))},I=["styles"];function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,_.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Z=e=>{let{styles:t={}}=e,r=(0,L.Z)(e,I);return(0,l.jsx)("svg",S(S({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,l.jsx)("path",{fill:"currentColor",d:"M21 12l-7-7v4C7 10 4 15 3 20c2.5-3.5 6-5.1 11-5.1V19l7-7z"})}))},T=["styles"];function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,_.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const V=e=>{let{styles:t={}}=e,r=(0,L.Z)(e,T);return(0,l.jsxs)("svg",F(F({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:[(0,l.jsx)("path",{fill:"currentColor",d:"M18.988 2.012l3 3L19.701 7.3l-3-3zM8 16h3l7.287-7.287-3-3L8 13z"}),(0,l.jsx)("path",{fill:"currentColor",d:"M19 19H8.158c-.026 0-.053.01-.079.01-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .896-2 2v14c0 1.104.897 2 2 2h14a2 2 0 002-2v-8.668l-2 2V19z"})]}))},M=e=>{let{gallery:t}=e;const r=(0,n.useRef)(null),s=(0,n.useRef)(null),a=(0,n.useMemo)((()=>t.createdDate.split(" ")[0]),[t.createdDate]);return(0,n.useEffect)((()=>{const e=r.current,n=s.current;t.content.length;let a=0,l=null;const c=function(){l=setInterval((()=>{n.textContent+=t.content.charAt(a),a+=1}),20)},o=function(){l&&clearInterval(l),n.textContent="",a=0};return e.addEventListener("mouseenter",c),e.addEventListener("mouseleave",o),()=>{e.removeEventListener("mouseenter",c),e.removeEventListener("mouseleave",o),l&&clearInterval(l)}}),[]),(0,l.jsxs)("div",{ref:r,className:"gallery-item",children:[(0,l.jsx)("svg",{children:(0,l.jsx)("rect",{})}),(0,l.jsx)("span",{children:t.name}),(0,l.jsxs)("div",{className:"gallery-item__icons",children:[(0,l.jsx)("button",{"data-cursor-scale":o.D,children:(0,l.jsx)(C,{})}),(0,l.jsx)("button",{"data-cursor-scale":o.D,children:(0,l.jsx)(V,{})}),(0,l.jsx)("button",{"data-cursor-scale":o.D,children:(0,l.jsx)(Z,{})})]}),(0,l.jsx)("span",{ref:s}),(0,l.jsx)("span",{children:a})]})};var R=r(6799);const U=()=>{const e=(0,n.useRef)(null),{data:t,isLoading:r,isError:s}=(0,g.a)(["gallery-list"],(()=>p.Z.get("/gallery/list")),{onSuccess:()=>{},onError:e=>{h.Z.addToast("error",e.message)},select:e=>e.data,staleTime:1/0});return(0,n.useEffect)((()=>{if(!t)return;const r=new IntersectionObserver((e=>{e.forEach((e=>{e.target.classList.toggle("show",e.isIntersecting),e.isIntersecting&&r.unobserve(e.target)}),{rootMargin:"-50px"})}));e.current.querySelectorAll(".gallery-list__item").forEach((e=>{r.observe(e)}))}),[t]),r?(0,l.jsx)(R.Z,{}):s?void 0:(0,l.jsxs)("div",{className:"gallery-list",ref:e,children:[(0,l.jsx)(D,{}),t.map((e=>(0,l.jsx)("div",{className:"gallery-list__item",children:(0,l.jsx)(M,{gallery:e})},e.galleryId)))]})},q={reg:/^[A-Za-z\dㄱ-ㅎㅏ-ㅣ가-힣]{5,10}$/,con:"한/영 조합 5~10자"};var A=r(4063);const B=()=>{const{mutate:e}=(0,A.Gn)();return(0,l.jsxs)("form",{className:"profile-form",onSubmit:function(t){t.preventDefault();const r=function(e){const t=e.get("nickname");return q.reg.test(t)?{result:!0,data:{nickname:t}}:{result:!1,reason:q.con}}(new FormData(t.currentTarget));r.result?e(r.data):h.Z.addToast("error","닉네임을 제대로 입력하쇼",2e3)},children:[(0,l.jsx)(u,{label:"닉네임",name:"nickname",initialValue:""}),(0,l.jsx)(v,{type:"submit",direction:"left",ariaLabel:"닉네임 수정",text:"수정하기"})]})};var H=r(7135);const $=()=>{const{data:e,isLoading:t,isError:r}=(0,A.bT)(),{mutate:n}=(0,A.JN)();return(0,l.jsxs)("form",{onSubmit:function(t){t.preventDefault();new FormData(t.currentTarget).get("nickname")==(null==e?void 0:e.nickname)&&n()},children:[(0,l.jsxs)("p",{children:["본인의 닉네임 ",null==e?void 0:e.nickname,"을 따라 입력해주세요"]}),(0,l.jsx)(u,{label:"닉네임",name:"nickname",initialValue:""}),(0,l.jsx)(v,{text:"회원 탈퇴",type:"submit"})]})},G=()=>{const e=(0,n.useRef)(null);(0,n.useEffect)((()=>{const t=e.current,r=function(){t.classList.add("open")},n=function(){t.classList.remove("open")};return t.addEventListener("mouseenter",r),t.addEventListener("mouseleave",n),()=>{t.removeEventListener("mouseenter",r),t.removeEventListener("mouseleave",n)}}),[]);const[t,r]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!1),{mutate:c}=(0,A.aU)();return(0,l.jsxs)("div",{className:"profile-edit",ref:e,children:[(0,l.jsxs)("div",{className:"profile-edit__menu",children:[(0,l.jsx)(v,{ariaLabel:"정보수정",text:"닉네임 수정",onClick:()=>r(!0)}),(0,l.jsx)(v,{ariaLabel:"로그아웃",text:"로그아웃",onClick:()=>c()}),(0,l.jsx)(v,{ariaLabel:"회원탈퇴",text:"회원탈퇴",onClick:()=>a(!0)})]}),(0,l.jsx)(H.Z,{ariaLabel:"더보기",children:(0,l.jsxs)("div",{className:"profile-edit__toggle",children:[(0,l.jsx)("span",{}),(0,l.jsx)("span",{}),(0,l.jsx)("span",{})]})}),(0,l.jsx)(i.Z,{isOpen:t,onClose:()=>r(!1),children:(0,l.jsx)(B,{})}),(0,l.jsx)(i.Z,{isOpen:s,onClose:()=>a(!1),children:(0,l.jsx)($,{})})]})};const J=function(){const[e,t]=(0,n.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"my-page",children:[(0,l.jsxs)("section",{className:"my-page__profile",children:[(0,l.jsx)(c,{}),(0,l.jsx)("div",{className:"my-page__profile__btn",children:(0,l.jsx)(G,{})})]}),(0,l.jsx)("div",{className:"my-page__br"}),(0,l.jsx)("section",{className:"my-page__gallery",children:(0,l.jsx)(U,{})})]}),(0,l.jsx)(i.Z,{isOpen:e,onClose:()=>t(!1),children:(0,l.jsx)(B,{})})]})}}}]);