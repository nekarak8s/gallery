"use strict";(self.webpackChunkgallery=self.webpackChunkgallery||[]).push([[381],{1495:(e,t,r)=>{r.r(t),r.d(t,{default:()=>ne});var n=r(7363),s=r(9451),l=r(5945),a=r(4469),c=r(9093),o=r(2731);const i={reg:/^[A-Za-z0-9가-힣\s]{1,15}$/,con:"한/영/숫자 조합 1~15자로 입력해주세요"},u={reg:/[\s\S]{1,150}/,con:"공백 포함 150자로 입력해주세요"},d={reg:/^[1-9]\d*$/,con:"공간값(숫자)이 올바르지 않습니다"};var m=r(3823);const f=e=>{let{className:t,onSubmit:r,children:s}=e;const l=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const e=l.current,t=Array.from(e.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])')),r=t.length;if(!r)return;const n=e=>{if("Enter"===e.key){e.preventDefault();const n=document.activeElement;if("INPUT"!==n.tagName||"text"!==n.type)return;const s=t.indexOf(n);if(-1===s||s===r-1)return;t[s+1].focus()}};return t.forEach((e=>{e.addEventListener("keydown",n)})),()=>{}}),[]),(0,m.jsx)("form",{ref:l,className:t,onSubmit:r,children:s})};var j=r(7355);const g=e=>{let{id:t,name:r,value:n,label:s="",children:l}=e;return(0,m.jsxs)("label",{htmlFor:t,className:"radio","data-cursor-scale":j.D,children:[(0,m.jsxs)("div",{className:"radio__label","data-cursor-scale":j.D,children:[(0,m.jsx)("input",{type:"radio",id:t,name:r,value:n,onKeyDown:function(e){"Enter"===e.key&&e.target.click()},"data-cursor-scale":j.D})," ",s]}),l]})},p=e=>{let{label:t,name:r,initialValue:n,onChange:s}=e;return(0,m.jsxs)("div",{className:"text",children:[(0,m.jsx)("input",{name:r,type:"text",placeholder:" ",defaultValue:n,onChange:s}),(0,m.jsx)("label",{children:t})]})},h=e=>{let{label:t,name:r,initialValue:s,defaultHeight:l=50,maxHeight:a=70,onChange:c}=e;const o=(0,n.useRef)(null);return(0,m.jsxs)("div",{className:"textarea",ref:o,children:[(0,m.jsx)("textarea",{name:r,defaultValue:s,onChange:e=>{e.target.classList.toggle("fill",e.target.value.length>0),e.target.style.height=e.target.scrollHeight>l?e.target.scrollHeight+"px":l+"px",c&&c(e)},style:{maxHeight:a}}),(0,m.jsx)("label",{children:t}),(0,m.jsx)("div",{})]})},x=e=>{let{text:t,ariaLabel:r=t,direction:n="left",type:s="button",size:l="md",color:a="black",onClick:c,onFocus:o,onBlur:i}=e;return(0,m.jsx)("button",{className:"button ".concat(n," ").concat(l," ").concat(a),type:s,onClick:c,onFocus:o,onBlur:i,onKeyDown:function(e){"Enter"===e.key&&e.target.click()},"aria-label":r,"data-cursor-scale":j.D,children:t})};var b=r(2233);const v=e=>{let{onSuccess:t,onError:r}=e;const{mutate:j,isLoading:v,isSuccess:y,isError:O}=function(){const e=(0,l.NL)();return(0,a.D)((e=>c.Z.post("/gallery",e)),{onSuccess:()=>{e.invalidateQueries(["gallery-list"])},onError:e=>{o.Z.addToast("error",e.message)}})}();(0,n.useEffect)((()=>(y&&t&&t(),O&&r&&r(),()=>{})),[y,O]);const{data:w,isLoading:E,isError:D}=(0,s.a)(["place"],(()=>c.Z.get("/gallery/place/list")),{onSuccess:()=>{},onError:e=>{o.Z.addToast("error",e.message)},select:e=>e.data,staleTime:1/0});if(!D)return E?(0,m.jsx)(b.Z,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(f,{className:"gallery-form",onSubmit:function(e){e.preventDefault();const t=function(e){const t=e.get("name");if(!i.reg.test(t))return{result:!1,reason:i.con};const r=e.get("content");if(!u.reg.test(r))return{result:!1,reason:u.con};const n=e.get("placeId");return d.reg.test(n)?{result:!0,data:{name:t,content:r,placeId:parseInt(n)}}:{result:!1,reason:d.con}}(new FormData(e.currentTarget));t.result?j(t.data):o.Z.addToast("error",t.reason)},children:[(0,m.jsx)(p,{label:"전시회 이름",name:"name",initialValue:""}),(0,m.jsx)(h,{label:"소개글",name:"content",initialValue:""}),(0,m.jsx)("div",{className:"gallery-form__place",children:w.map((e=>(0,m.jsx)(g,{id:"place-".concat(e.placeId),name:"placeId",label:e.name,value:e.placeId,children:(0,m.jsx)("img",{src:e.twoDimensionImageUrl,alt:"".concat(e.name," 공간")})},e.placeId)))}),(0,m.jsx)(x,{type:"submit",direction:"left",ariaLabel:"전시회 생성",text:"전시회 개관"})]}),v&&(0,m.jsx)("div",{className:"gallery-form__loading",children:(0,m.jsx)(b.Z,{})})]})};var y=r(5301),O=r(6735);const w=["styles"];function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const _=e=>{let{styles:t={}}=e,r=(0,O.Z)(e,w);return(0,m.jsx)("svg",D(D({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,m.jsx)("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 01-2 0v-5H6a1 1 0 010-2h5v-5a1 1 0 012 0v5h5a1 1 0 010 2z"})}))};var L=r(3165);const P=()=>{const[e,t]=(0,n.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{className:"gallery-create","aria-label":"전시회 생성","data-cursor-scale":j.D,onClick:()=>{t(!0)},children:(0,m.jsx)(_,{})}),(0,m.jsx)(L.Z,{isOpen:e,onClose:()=>t(!1),children:(0,m.jsx)(v,{onSuccess:()=>t(!1)})})]})},S=["styles"];function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Z=e=>{let{styles:t={}}=e,r=(0,O.Z)(e,S);return(0,m.jsxs)("svg",N(N({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:[(0,m.jsx)("path",{fill:"currentColor",d:"M18.988 2.012l3 3L19.701 7.3l-3-3zM8 16h3l7.287-7.287-3-3L8 13z"}),(0,m.jsx)("path",{fill:"currentColor",d:"M19 19H8.158c-.026 0-.053.01-.079.01-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .896-2 2v14c0 1.104.897 2 2 2h14a2 2 0 002-2v-8.668l-2 2V19z"})]}))},C=["styles"];function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const F=e=>{let{styles:t={}}=e,r=(0,O.Z)(e,C);return(0,m.jsx)("svg",T(T({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,m.jsx)("path",{fill:"currentColor",d:"M12 2a10 10 0 1010 10A10 10 0 0012 2zm-2 14.5v-9l6 4.5z"})}))},V=["styles"];function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const A=e=>{let{styles:t={}}=e,r=(0,O.Z)(e,V);return(0,m.jsx)("svg",H(H({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r),{},{children:(0,m.jsx)("path",{fill:"currentColor",d:"M21 12l-7-7v4C7 10 4 15 3 20c2.5-3.5 6-5.1 11-5.1V19l7-7z"})}))},M=e=>{let{gallery:t}=e;const r=(0,n.useRef)(null),s=(0,n.useRef)(null),l=(0,n.useRef)(null),a=(0,n.useMemo)((()=>t.createdDate.split(" ")[0]),[t.createdDate]);return(0,n.useEffect)((()=>{const e=r.current,n=s.current.querySelectorAll("button"),a=l.current;t.content.length;let c=0,o=null;const i=function(){e.classList.add("selected"),o||(o=setInterval((()=>{a.textContent+=t.content.charAt(c),c+=1}),20))},u=function(){e.classList.remove("selected"),o&&clearInterval(o),o=null,a.textContent="",c=0};return e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",u),n.forEach((e=>{e.addEventListener("focus",i),e.addEventListener("blur",u)})),()=>{e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",u),n.forEach((e=>{e.removeEventListener("focus",i),e.removeEventListener("blur",u)})),o&&clearInterval(o)}}),[]),(0,m.jsxs)("div",{className:"gallery-item",ref:r,children:[(0,m.jsx)("h2",{className:"gallery-item__title",children:t.name}),(0,m.jsxs)("ul",{className:"gallery-item__icons",ref:s,children:[(0,m.jsx)("li",{children:(0,m.jsx)("button",{"data-cursor-scale":j.D,children:(0,m.jsx)(F,{})})}),(0,m.jsx)("li",{children:(0,m.jsx)("button",{"data-cursor-scale":j.D,children:(0,m.jsx)(Z,{})})}),(0,m.jsx)("li",{children:(0,m.jsx)("button",{"data-cursor-scale":j.D,children:(0,m.jsx)(A,{})})})]}),(0,m.jsxs)("div",{className:"gallery-item__content",children:[(0,m.jsx)("div",{ref:l}),(0,m.jsx)("p",{children:t.content})]}),(0,m.jsx)("time",{className:"gallery-item__date",children:a}),(0,m.jsxs)("div",{className:"gallery-item__borders",children:[(0,m.jsx)("div",{}),(0,m.jsx)("div",{}),(0,m.jsx)("div",{}),(0,m.jsx)("div",{})]})]})},B=()=>{const e=(0,n.useRef)(null),{data:t,isLoading:r,isError:l}=(0,s.a)(["gallery-list"],(()=>c.Z.get("/gallery/list")),{onSuccess:()=>{},onError:e=>{o.Z.addToast("error",e.message)},select:e=>e.data,staleTime:1/0});return(0,n.useEffect)((()=>{if(!t)return;const r=new IntersectionObserver((e=>{e.forEach((e=>{e.target.classList.toggle("show",e.isIntersecting),e.isIntersecting&&r.unobserve(e.target)}),{rootMargin:"-150px"})}));e.current.querySelectorAll(".gallery-list__item").forEach((e=>{r.observe(e)}))}),[t]),r?(0,m.jsx)(b.Z,{}):l?void 0:(0,m.jsxs)("div",{className:"gallery-list",ref:e,children:[(0,m.jsx)(P,{}),t.map((e=>(0,m.jsx)("div",{className:"gallery-list__item",children:(0,m.jsx)(M,{gallery:e})},e.galleryId)))]})};var q=r(4063);const R=e=>{let{onLoaded:t}=e;const{data:r,isLoading:s,isError:l}=(0,q.bT)(),[a,c]=(0,n.useState)(0);return(0,n.useEffect)((()=>{if(!r)return;c(Math.floor(((new Date).getTime()-new Date(r.createdDate).getTime())/6e4));const e=setInterval((()=>{c((e=>e+1))}),6e4);return t&&t(),()=>{e&&clearInterval(e)}}),[r]),s?(0,m.jsx)(b.Z,{}):l?(0,m.jsx)("div",{}):(0,m.jsxs)("div",{className:"profile",children:[(0,m.jsxs)("span",{children:[r.nickname,"님의 작업실"]}),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{children:a}),"분 운영 중"]})]})};var U=r(1807);const $=()=>{const{data:e,isLoading:t,isError:r}=(0,q.bT)(),{mutate:n}=(0,q.JN)();return(0,m.jsxs)("form",{className:"withdrawl-form",onSubmit:function(t){t.preventDefault();new FormData(t.currentTarget).get("nickname")!==(null==e?void 0:e.nickname)?o.Z.addToast("error","닉네임이 올바르지 않습니다"):n()},children:[(0,m.jsxs)("p",{children:["본인의 닉네임 ",(0,m.jsx)("b",{children:null==e?void 0:e.nickname}),"을 정확하게 입력해주세요"]}),(0,m.jsx)(p,{label:"닉네임",name:"nickname",initialValue:""}),(0,m.jsx)(x,{text:"회원 탈퇴",type:"submit"})]})};var K=r(4315);const G=["styles"];function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const W=e=>{let{styles:t={}}=e,r=(0,O.Z)(e,G);return(0,m.jsx)("svg",Q(Q({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},r),{},{children:(0,m.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",children:[(0,m.jsx)("circle",{cx:"8",cy:"2.5",r:".9"}),(0,m.jsx)("circle",{cx:"8",cy:"8",r:".9"}),(0,m.jsx)("circle",{cx:"8",cy:"13.5",r:".9"})]})}))};var X=r(7135),Y=r(2914);const ee={reg:/^[A-Za-z\dㄱ-ㅎㅏ-ㅣ가-힣]{2,10}$/,con:"닉네임은 한/영 조합 2~10자로 입력해주세요"};const te=e=>{let{onSuccess:t,onError:r}=e;const{mutate:s,isSuccess:l,isError:a,isLoading:c}=(0,q.Gn)();(0,n.useEffect)((()=>(l&&t&&t(),a&&r&&r(),()=>{})),[l,a]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(f,{className:"profile-form",onSubmit:function(e){e.preventDefault();const t=function(e){const t=e.get("nickname");return ee.reg.test(t)?{result:!0,data:{nickname:t}}:{result:!1,reason:ee.con}}(new FormData(e.currentTarget));t.result?s(t.data):o.Z.addToast("error","".concat(t.reason))},children:[(0,m.jsx)(p,{label:"닉네임",name:"nickname",initialValue:""}),(0,m.jsx)(x,{type:"submit",direction:"left",ariaLabel:"닉네임 수정",text:"수정하기"})]}),c&&(0,m.jsx)("div",{className:"profile-form__loading",children:(0,m.jsx)(b.Z,{})})]})},re=()=>{const e=(0,n.useRef)(null),[t,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const t=e.current,n=function(){r(!0)},s=function(){r(!1)};return t.addEventListener("mouseenter",n),t.addEventListener("mouseleave",s),()=>{t.removeEventListener("mouseenter",n),t.removeEventListener("mouseleave",s)}}),[]);const[s,l]=(0,n.useState)(!1),[a,c]=(0,n.useState)(!1),{mutate:o,isSuccess:i}=(0,q.aU)(),u=(0,U.s0)();return(0,n.useEffect)((()=>{i&&u(K._.Home)}),[i]),(0,m.jsxs)("div",{className:"profile-edit",ref:e,children:[(0,m.jsx)(X.Z,{ariaLabel:"더보기",onFocus:()=>r(!0),children:(0,m.jsx)("div",{className:"profile-edit__toggle",children:(0,m.jsx)(W,{})})}),(0,m.jsxs)(Y.Z,{className:"profile-edit__menu",isShow:t,duration:200,timingFunction:"ease-in-out",children:[(0,m.jsx)(x,{ariaLabel:"정보수정",text:"닉네임 수정",direction:"right",onClick:()=>l(!0)}),(0,m.jsx)(x,{ariaLabel:"로그아웃",text:"로그아웃",direction:"center",onClick:()=>o()}),(0,m.jsx)(x,{ariaLabel:"회원탈퇴",text:"회원탈퇴",direction:"bottom",onClick:()=>c(!0),onBlur:()=>r(!1)})]}),(0,m.jsx)(L.Z,{isOpen:s,onClose:()=>l(!1),children:(0,m.jsx)(te,{onSuccess:()=>l(!1)})}),(0,m.jsx)(L.Z,{isOpen:a,onClose:()=>c(!1),children:(0,m.jsx)($,{})})]})};const ne=function(){return(0,m.jsxs)("div",{className:"my-page",children:[(0,m.jsxs)("section",{className:"my-page__profile",onAnimationEnd:function(){var e,t,r;null===(e=document.querySelector(".my-page__profile-edit"))||void 0===e||e.classList.add("block"),null===(t=document.querySelector(".my-page__line"))||void 0===t||t.classList.add("block"),null===(r=document.querySelector(".my-page__gallery"))||void 0===r||r.classList.add("block")},children:[(0,m.jsx)(R,{onLoaded:function(){var e;null===(e=document.querySelector(".my-page__profile"))||void 0===e||e.classList.add("loaded")}}),(0,m.jsx)("div",{className:"my-page__profile-edit",children:(0,m.jsx)(re,{})})]}),(0,m.jsx)("div",{className:"my-page__line"}),(0,m.jsx)("section",{className:"my-page__gallery",children:(0,m.jsx)(B,{})})]})}}}]);